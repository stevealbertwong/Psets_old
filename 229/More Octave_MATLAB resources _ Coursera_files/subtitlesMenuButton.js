define("bundles/videojs/plugins/subtitlesMenuButton",["require","exports","module","jquery","underscore","videojs","bundles/videojs/layout/controls.html","bundles/videojs/plugins/subtitlesOffMenuItem","bundles/videojs/plugins/subtitlesMenu","bundles/videojs/plugins/subtitlesMenuItem"],function(require,exports,module){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var u=function(){function defineProperties(o,n){for(var t=0;t<n.length;t++){var e=n[t];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(o,e.key,e)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),$=require("jquery"),_=require("underscore"),t=require("videojs"),n=require("bundles/videojs/layout/controls.html");require("bundles/videojs/plugins/subtitlesOffMenuItem"),require("bundles/videojs/plugins/subtitlesMenu"),require("bundles/videojs/plugins/subtitlesMenuItem");var o=38,s=40,i=9,r=13,l=32,a=27,e="vjs-highlighted",c=function handleUpAndDownArrowKeys(u,o){var t=_(u.children_).filter(function(e){return!e.hasClass("vjs-hidden")}),i=_(t).find(function(t){return t.hasClass(e)}),n=-1;i&&(n=_(t).chain().map(function(e){return e.el_}).indexOf(i.el_).value(),-1!==n&&t[n].removeClass(e)),0>=n&&-1===o?t[t.length-1].addClass(e):(0>n||n>=t.length-1)&&1===o?t[0].addClass(e):t[n+o].addClass(e)},f=function handleTabAndEscapeKeys(t){t.unlockShowing(),_(t.children_).each(function(t){t.removeClass(e)})},d=function handleEnterAndSpaceKeys(t){var o=_(t.children_).filter(function(e){return!e.hasClass("vjs-hidden")}),n=_(o).find(function(t){return t.hasClass(e)});n&&n.handleClick(),t.lockShowing()},h=function(h){function SubtitlesMenuButton(t){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];_classCallCheck(this,SubtitlesMenuButton);var e=_possibleConstructorReturn(this,Object.getPrototypeOf(SubtitlesMenuButton).call(this,t,n)),o=n.defaultSubtitleLanguage;return o?e.menu.showSubtitleOffItem():e.menu.hideSubtitleOffItem(),e.one(t,"ready",function(){_(t.textTracks()).forEach(function(e){e.language===o?e.mode="showing":e.mode="hidden"})}),e}return _inherits(SubtitlesMenuButton,h),u(SubtitlesMenuButton,[{key:"createEl",value:function createEl(o,i){var t=$(n({controlName:"subtitlesMenuButton"}));return this.contentEl_=t.find(".vjs-control-content").get(0),t.on("focus",function(){var t=this.player_.controlBar.subtitlesMenuButton.menu;_(t.children_).last().addClass(e),t.lockShowing()}.bind(this)),t.get(0)}},{key:"onKeyPress",value:function onKeyPress(e){var t=$(this.player_.controlBar.subtitlesMenuButton.contentEl_),n=this.player_.controlBar.subtitlesMenuButton.menu;e.keyCode===o||e.keyCode===s?(c(n,e.keyCode===o?-1:1),t.focus(),e.preventDefault(),e.stopPropagation()):e.keyCode===i||e.keyCode===a?(f(n),t.blur()):(e.keyCode===r||e.keyCode===l)&&(d(n),t.focus(),e.preventDefault(),e.stopPropagation())}},{key:"handleClick",value:function handleClick(i){this.player_.controlBar.subtitlesMenuButton.menu.unlockShowing();var e=this.player_.textTracks(),t=_(e).findWhere({mode:"showing"});if(t)t.mode="disabled";else if(e.length){var n=_(e).findWhere({"default":!0});if(n)n.mode="showing";else{var o=_(e).findWhere({language:"en"});o?o.mode="showing":e[0].mode="showing"}}}},{key:"createMenu",value:function createMenu(){var i=t.getComponent("SubtitlesMenu"),e=new i(this.player_,this.options_.subtitlesMenu);this.items=this.createItems(),this.items.forEach(function(t){return e.addItem(t)});var o=e.contentEl().children[0]||null;return e.contentEl().insertBefore($(n({controlName:"subtitlesMenuTitle"}))[0],o),e.contentEl().insertBefore($(n({controlName:"menuDivider"}))[0],o),e}},{key:"createItems",value:function createItems(){var n=t.getComponent("SubtitlesOffMenuItem"),e=new n(this.player_,{kind:"subtitles",id:"subtitles-off"});e.hide();var o=t.getComponent("SubtitlesMenuItem");return[e].concat(_.chain(this.player_.textTracks()).filter(function(e){return"subtitles"===e.kind}).map(function(e){return new o(this.player_,{track:e,selectable:!0})},this).value())}}]),SubtitlesMenuButton}(t.getComponent("SubtitlesButton"));t.registerComponent("SubtitlesMenuButton",h)});